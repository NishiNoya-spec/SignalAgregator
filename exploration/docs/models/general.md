## Проведение экспериментов

При проведении экспериментов применять:

1) [Стандарты разработки компании. Первичный анализ](https://tfs.msk.evraz.com/tfs/%D0%9F%D0%BE%D1%80%D1%82%D1%84%D0%B5%D0%BB%D1%8C%20%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%BE%D0%B2/IT_Docs/_wiki/wikis/%D0%A1%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%8B%20%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8/7113/%D0%9F%D0%B5%D1%80%D0%B2%D0%B8%D1%87%D0%BD%D1%8B%D0%B9-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85-(Data-Exploration));
2) [Стандарты компании. Построение первой версии моделей](https://tfs.msk.evraz.com/tfs/%D0%9F%D0%BE%D1%80%D1%82%D1%84%D0%B5%D0%BB%D1%8C%20%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%BE%D0%B2/IT_Docs/_wiki/wikis/%D0%A1%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D1%8B%20%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8/7114/%D0%9F%D0%BE%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B5%D1%80%D0%B2%D0%BE%D0%B9-%D0%B2%D0%B5%D1%80%D1%81%D0%B8%D0%B8-%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B5%D0%B9)
3) Алгоритм построения моделей:

| № п/п | Вид работ                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Успешно                                                     | Неуспешно                                               |
|-------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|---------------------------------------------------------|
| 1     | Формирование гипотезы                                                                                                                                                                                                                                                                                                                                                                                                                                        | Переход к п. 2                                              | -                                                       |
| 2     | Разведочный анализ данных: поиск выбросов, видимых аномалий и т.д.                                                                                                                                                                                                                                                                                                                                                                                           | Переход к п. 3                                              | Переход к п.2.1                                         |
| 2.1   | Корректировка сигналов из источника                                                                                                                                                                                                                                                                                                                                                                                                                          | Переход к п.2                                               | Переход к п.2.2                                         |
| 2.2   | Проверка алгоритма препроцессинга и фичиинжениринга                                                                                                                                                                                                                                                                                                                                                                                                          | Переход к п.2                                               | Переход к п.2.3                                         |
| 2.3   | Корректировка пропроцессинга и фичиинжениринга                                                                                                                                                                                                                                                                                                                                                                                                               | Переход к п.2                                               | Переход к п.2                                           |
| 3     | "Обучение базовых моделей, как минимум по 1 из каждого типа. Для регрессии: линейные: Linear, Ridge, Lasso, Lars, ElasticNet, деревья решений: Tree, случайный лес:  RandomForest, градиентный бустинг деревьев решений: LGBM, GradientBoosting, CatBoost. Для классификации: линейные: Linear, Ridge, метод ближайших соседей: KNN, деревья решений: Tree, случайный лес:  RandomForest, градиентный бустинг деревьев решений: GradientBoosting, CatBoost." | Переход к п.4                                               | Переход к п.2                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                              
| 4     | Оценка метрик:                                                                                                                                                                                                                                                                                                                                                                                                                                               | Переход к п.7                                               | Переход к п.5                                           |
| 4.1   | "Оценка общих метрик: r2, rmse, mae, me, mse, mape - регрессия; accuracy, precision_micro,  precision_macro, recall_micro,  recall_macro,  f1_micro,  f1_macro,  ROC_AUC_micro,  ROC_AUC_macro - классификация                                                                                                                                                                                                                                               | -                                                           | -                                                       || 4.2   | Оценка метрик из п.4 по сплитам кросс-валидации | - | -
| 4.3   | Анализ зависимостей с использованием SHAP                                                                                                                                                                                                                                                                                                                                                                                                                    | -                                                           | -                                                       |
| 5     | Пути улушения метрик (если метрики не удовлетворительны)                                                                                                                                                                                                                                                                                                                                                                                                     | Переход к п.7                                               | Переход к п.2, либо к п.6                               |
| 5.1   | Анализ отобранных для обучения признаков                                                                                                                                                                                                                                                                                                                                                                                                                     | -                                                           | -                                                       |
| 5.2   | Анализ глубины данных                                                                                                                                                                                                                                                                                                                                                                                                                                        | -                                                           | -                                                       |
| 5.3   | Анализ причин выбросов данных                                                                                                                                                                                                                                                                                                                                                                                                                                | -                                                           | -                                                       |
| 6     | Дополнительные пути улушения метрик (опционально)                                                                                                                                                                                                                                                                                                                                                                                                            | Переход к п.7                                               | Гипотеза не подтверждается, используем другую агрегацию |
| 6.1   | Расширяем выборку                                                                                                                                                                                                                                                                                                                                                                                                                                            | -                                                           | -                                                       |
| 6.2   | Подбор гиперпараметров                                                                                                                                                                                                                                                                                                                                                                                                                                       | -                                                           | -                                                       |
| 6.3   | Подбор ограничений на область действия модели                                                                                                                                                                                                                                                                                                                                                                                                                | -                                                           | -                                                       |
| 6.4   | "Подбор смещений временных рядов, для учёта ""отложенных"" зависимостей"                                                                                                                                                                                                                                                                                                                                                                                     | -                                                           | -                                                       |
| 6.5   | "Обучение ""прокси"" моделей для предсказания фичей, значения которых влияют ""из будущего"""                                                                                                                                                                                                                                                                                                                                                                | -                                                           | -                                                       |
| 7     | Тестирование модели на новых производственных данных, в том числе в составе подсказчика                                                                                                                                                                                                                                                                                                                                                                      | Переход в прод                                              | Переход к п. 8                                          |
| 8     | Поиск и анализ аномалий в сигналах                                                                                                                                                                                                                                                                                                                                                                                                                           | Корректировка значений сигналов из источника, переход к п.7 | Переход к п. 8                                          |
| 9     | Добавление новых данных к обучающей выборке, переход к п.2.                                                                                                                                                                                                                                                                                                                                                                                                  | Выход в прод                                                | Гипотеза не подтверждается                              |

## Правила ведения раздела

1) Добавить в директорию для выбранного таргета папку с номером/названием эксперимента.
2) Если Эксперимент типовой, то:
   1) Добавить в папку настроичный файл препроцессинга текущего эксперимента
   2) Добавить код обучения модели (evraz-ds)
   
3) Если эксперимент не типовой, то:
   1) Добавить все файлы эксперимента от препроцессинга до обучения. 
   2) Добавить файл с инструкцией по воспроизведению экспериментов

4) Добавить описание модели в документацию

